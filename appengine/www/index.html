<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<meta property="og:title" content="Shubz.TV"/>
	<meta property="og:type" content="video"/>
    <meta property="og:site_name" content="Shubz.TV"/>
	<title>Shubz.TV - Watch with your friends!</title>
	<link href="../styles/samples.css" type="text/css" rel="stylesheet">
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
	<script language="javascript" src="../scripts/jquery.juitter.js" type="text/javascript"></script>
	<script language="javascript" src="../scripts/system.js" type="text/javascript"></script>
	<script language="javascript" src="../scripts/yt.js" type="text/javascript"></script>
	<script language="javascript" src="../scripts/room_actions.js" type="text/javascript"></script>	
	<script src="http://staging.tokbox.com/v0.91/js/TB.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="http://connect.facebook.net/en_US/all.js"></script>
	<script src="../scripts/everything.js" type="text/javascript" charset="utf-8">
	</script>
</head>
<body>

<div id="body">
	<table><tr><td>
		<div id="header">
			<h1>Shubz.TV</h1>
			<div id="instructions">
				<strong>Hey, what should I do?</strong>
				<p>Start by clicking here to 
		       	<input type="button" value="enter the room" id ="connectLink" onClick="javascript:connect()" />
		       	<input type="button" value="leave the room" id ="disconnectLink" onClick="javascript:disconnect()" />
				</p>
				<p>
				Then, click here to
		       	<input type="button" value="activate your camera" id ="publishLink" onClick="javascript:startPublishing()" />
		       	<input type="button" value="turn off your camera" id ="unpublishLink" onClick="javascript:stopPublishing()" />
				</p>
				<p>
				Finally, watch with friends!
				</p>
			</div>
		</div>
		<div id="chat">
	   	   <div id="myCamera" class="publisherContainer"></div>
		   <div id="subscribers"></div>
			<div id="opentok_console"></div>
		</div>
	</td><td>
		<div id="video">
		  <script type="text/javascript" src="../scripts/swfobject.js"></script>
		  <div id="ytapiplayer">
		    You need Flash player 8+ and JavaScript enabled to view this video.
		  </div>

		  <script type="text/javascript">

		    var params = { allowScriptAccess: "always" };
		    var atts = { id: "myytplayer" };
		    swfobject.embedSWF("http://www.youtube.com/apiplayer?enablejsapi=1&playerapiid=ytplayer",
		                       "ytapiplayer", "640", "385", "8", null, null, params, atts);

		  </script>
		</div>
		<div id="videochooser">
			<ol id="videolist">
				<li>Loading Videos...</li>
			</ol>
		</div>
        <form id="add-url-form">
           <label>Paste a URL:</label><input id="youtube-url" type="text" name="url" placeholder="YouTube URL" size="40"/>
        </form>
        
		<div id="juitterContainer"></div>
	</tr>
	</table>
</div>

       <div id="fb-root"></div>

       	 <div id="fbLoginDiv" >
	    <fb:login-button perms="user_videos, xmpp_login, publish_stream" autologoutlink="true" onlogin="OnToggleLogin()">
        </fb:login-button>
        </div>

	    <div id="fbLogoutDiv" style="display:none">
        </div>

        <div id="fbInviteDiv" style="display:none">
        <!--
        <fb:send id="fbSendLink" ref="shubz.tv" href=document.URL + "#session=" + sessionId></fb:send>
        //-->
        <a href="javascript:InviteFriends()">Invite friends</a>
        </div>





      <script>
         FB.init({
            appId:'8796512710', cookie:true,
            status:true, xfbml:true
         });

        var loginDiv = document.getElementById("fbLoginDiv");
        var logoutDiv = document.getElementById("fbLogoutDiv");
        var inviteDiv = document.getElementById("fbInviteDiv");

        FB.getLoginStatus(function(response) {
            if (response.session) {
        		loginDiv.style.display = "none";
        		logoutDiv.style.display = "block";
        		inviteDiv.style.display = "block";
	        }else {
        		loginDiv.style.display = "block";
        		logoutDiv.style.display = "none";
        		inviteDiv.style.display = "none";
        	}
        });

        function InviteFriends()
        {

            FB.ui({method: 'send', message: 'Come watch this awesome video with me:' + document.URL + "#session="+ sessionId});

        }

        function OnToggleLogin()
        {

            loginDiv.style.display = "none";
        	logoutDiv.style.display = "block";
        	inviteDiv.style.display = "block";
        }

      </script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-23056696-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</body>
</html>
